local TabletConfig = require(script.Parent.Parent.Parent.TabletConfig)
local ScreenGUI = script.Parent.ControlOS
local RoomConfig = require(TabletConfig.RoomLocation.RoomConfig)
local WhitelistLoading = true
-- Game Time --
local Starthr = tonumber(string.sub(game.Lighting.TimeOfDay,1,2))
local Startmn = string.sub(game.Lighting.TimeOfDay,4,5)
ScreenGUI.Time.Text = Starthr .. ":" .. Startmn

game.Lighting.Changed:Connect(function ()
	local hr = tonumber(string.sub(game.Lighting.TimeOfDay,1,2))
	local mn = string.sub(game.Lighting.TimeOfDay,4,5)
	ScreenGUI.Time.Text = hr .. ":" .. mn
end)
-- Boot Sequence --
local WhitelistEndPosition = UDim2.new(0, -437, 0, 0)
local WhitelistStartPosition = UDim2.new(0, 0, 0, 0)

local function Yessir(Data)
	if Data == "WhitelistTrue" then
		task.wait(7)
		WhitelistLoading = false
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked✅"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked✅"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked✅"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked✅"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked✅"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked✅"
		task.wait(3)
		ScreenGUI.WhitelistScreen:TweenPosition(WhitelistEndPosition, Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
		game.TweenService:Create(ScreenGUI.Time, TweenInfo.new(1), {TextTransparency = 1}):Play()
		wait(1.5)
		ScreenGUI.LoginScreen:TweenPosition(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.In, Enum.EasingStyle.Linear, 2)
		wait(2)
		game.TweenService:Create(ScreenGUI.Time, TweenInfo.new(1), {TextTransparency = 0}):Play()
	elseif Data == "WhitelistFalse" then
		task.wait(4)
		WhitelistLoading = false
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked❌"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked❌"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked❌"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked❌"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked❌"
		wait(0.1)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Checked❌"
		return
	end
end
TabletConfig.RoomLocation.Parent.Parent.Event.Event:Connect(Yessir)
wait(3)
ScreenGUI.WhitelistScreen:TweenPosition(WhitelistStartPosition, Enum.EasingDirection.In, Enum.EasingStyle.Linear, 2)
-- Profiles --
local CurrentProfile = 0
for _, Profile in pairs(RoomConfig.Profiles) do
	CurrentProfile += 1
	local User = Profile["UserID"]
	local Player = game.Players:GetPlayerByUserId(User)

	local ImageSize = Enum.ThumbnailSize.Size150x150 -- Thumbnail Size
	local ImageType = Enum.ThumbnailType.HeadShot -- Thumbnail Type

	local content = game.Players:GetUserThumbnailAsync(Player.UserId, ImageType, ImageSize)
	if CurrentProfile == 1 then
		ScreenGUI.LoginScreen.Profiles.ProfileImage1.Image = content
		ScreenGUI.LoginScreen.Profiles.ProfileName1.Text = Player.DisplayName
		ScreenGUI.LoginScreen.Profiles.Profile1.MouseButton1Click:Connect(function()
			ScreenGUI.Homescreen.TextLabel.Text = "Good evening, " .. Player.DisplayName
			ScreenGUI.LoginScreen:TweenPosition(UDim2.new(0, 0, 0, -315), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
			wait(1.5)
			ScreenGUI.Homescreen:TweenPosition(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
		end)
	elseif CurrentProfile == 2 then
		ScreenGUI.LoginScreen.Profiles.ProfileImage2.Image = content
		ScreenGUI.LoginScreen.Profiles.ProfileName2.Text = Player.DisplayName
		ScreenGUI.LoginScreen.Profiles.Profile2.MouseButton1Click:Connect(function()
			ScreenGUI.Homescreen.TextLabel.Text = "Good evening, " .. Player.DisplayName
			ScreenGUI.LoginScreen:TweenPosition(UDim2.new(0, 0, 0, -315), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
			wait(1.5)
			ScreenGUI.Homescreen:TweenPosition(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
		end)
	elseif CurrentProfile == 3 then
		ScreenGUI.LoginScreen.Profiles.ProfileImage3.Image = content
		ScreenGUI.LoginScreen.Profiles.ProfileName3.Text = Player.DisplayName
		ScreenGUI.LoginScreen.Profiles.Profile3.MouseButton1Click:Connect(function()
			ScreenGUI.Homescreen.TextLabel.Text = "Good evening, " .. Player.DisplayName
			ScreenGUI.LoginScreen:TweenPosition(UDim2.new(0, 0, 0, -315), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
			wait(1.5)
			ScreenGUI.Homescreen:TweenPosition(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 2)
		end)
	end
end
-- Backgrounds --
if TabletConfig.BackgroundImage ~= "" then
	ScreenGUI.BackGround.Visible = false
	ScreenGUI.Background.Image = TabletConfig.BackgroundImage
end
if TabletConfig.BackgroundColor ~= Color3.fromRGB() and TabletConfig.BackgroundImage == "" then
	ScreenGUI.Background.Visible = false
	ScreenGUI.BackGround.Visible = true
	ScreenGUI.BackGround.BackgroundColor3 = TabletConfig.BackgroundColor
	ScreenGUI.BackGround.BackgroundTransparency = 0
end
if TabletConfig.BackgroundColor == Color3.fromRGB() and TabletConfig.BackgroundImage == "" and TabletConfig.BackgroundGradiant["FirstColor"] ~= Color3.fromRGB() then
	ScreenGUI.Background.Visible = false
	ScreenGUI.BackGround.Visible = true
	ScreenGUI.BackGround.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	ScreenGUI.BackGround.BackgroundTransparency = 0
	local Time 
	if TabletConfig.BackgroundGradiant["Sequence"] == "Start" then
		Time = 0
	elseif TabletConfig.BackgroundGradiant["Sequence"] == "InbetweenS&M" then
		Time = 0.25
	elseif TabletConfig.BackgroundGradiant["Sequence"] == "Middle" then
		Time = 0.5
	elseif TabletConfig.BackgroundGradiant["Sequence"] == "InbetweenM&E" then
		Time = 0.75
	elseif TabletConfig.BackgroundGradiant["Sequence"] == "End" then
		Time = 1
	end
	if Time == 0 then
		ScreenGUI.BackGround.UIGradient.Color = ColorSequence.new({ColorSequenceKeypoint.new(Time, TabletConfig.BackgroundGradiant["FirstColor"]), ColorSequenceKeypoint.new(1, TabletConfig.BackgroundGradiant["SecondColor"])})
		ScreenGUI.BackGround.UIGradient.Enabled = true
	elseif Time == 1 then
		ScreenGUI.BackGround.UIGradient.Color = ColorSequence.new({ColorSequenceKeypoint.new(Time, TabletConfig.BackgroundGradiant["SecondColor"]), ColorSequenceKeypoint.new(1, TabletConfig.BackgroundGradiant["FirstColor"])})
		ScreenGUI.BackGround.UIGradient.Enabled = true
	else
		ScreenGUI.BackGround.UIGradient.Color = ColorSequence.new({ColorSequenceKeypoint.new(0, TabletConfig.BackgroundGradiant["SecondColor"]), ColorSequenceKeypoint.new(Time, TabletConfig.BackgroundGradiant["FirstColor"]), ColorSequenceKeypoint.new(1, TabletConfig.BackgroundGradiant["SecondColor"])})
		ScreenGUI.BackGround.UIGradient.Enabled = true
	end
end
--for _, child in pairs(ScreenGUI:GetChildren()) do
--	if TabletConfig.DarkMode == true then
--		if child:IsA("TextLabel") then
--			child.TextColor3 = Color3.fromRGB(255, 255, 255)
--		end
--	else
--		if child:IsA("TextLabel") then
--			child.TextColor3 = Color3.fromRGB(0, 0, 0)
--		end
--	end
--end
-- Weather --
if game.ReplicatedStorage:FindFirstChild("WeatherResources") then
	local CurrentWeather = game.ReplicatedStorage:FindFirstChild("WeatherResources").Weather.Current
	ScreenGUI.Homescreen.WeatherUI.Temp.Text = "Temprature: " .. CurrentWeather.Temperature.Value .. "°"
	CurrentWeather.Temperature.Changed:Connect(function ()
		ScreenGUI.Homescreen.WeatherUI.Temp.Text = "Temprature: " .. CurrentWeather.Temperature.Value .. "°"
	end)
	ScreenGUI.Homescreen.WeatherUI.Weather.Text = "Weather: " .. CurrentWeather.Weather.Value
	CurrentWeather.Weather.Changed:Connect(function ()
		ScreenGUI.Homescreen.WeatherUI.Weather.Text = "Weather: " .. CurrentWeather.Weather.Value
	end)
end

-- While Loops --
task.spawn(function ()
	while WhitelistLoading == true do
		wait(0.5)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Loading."
		if WhitelistLoading == false then return end
		wait(0.5)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Loading.."
		if WhitelistLoading == false then return end
		wait(0.5)
		ScreenGUI.WhitelistScreen.Whitelist.WhitelistLoading.Text = "Whitelist Loading..."
		if WhitelistLoading == false then return end
	end
end)
